<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        /* Your existing CSS styles here */
        @media print {
            .no-print { display: none !important; }
            .print-area { 
                width: 100% !important; 
                margin: 0 !important; 
                padding: 20px !important;
                box-shadow: none !important;
            }
            body { margin: 0; padding: 0; }
        }
        
        .resume-template {
            min-height: 800px;
            font-family: 'Arial', sans-serif;
        }
        
        /* ... rest of your CSS ... */
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Your existing HTML structure here -->
    <div class="container mx-auto px-4 py-8">
        <!-- ... header, form sections, etc. ... -->
    </div>

    <script>
        // ======================
        // ENHANCED RESUME BUILDER
        // ======================
        document.addEventListener('DOMContentLoaded', function() {
            // ✅ DYNAMIC STORAGE KEY FOR GITHUB PAGES
            const STORAGE_KEY = window.location.pathname.includes('resumebuilder') 
                ? '/resumebuilder/resumeData' 
                : 'resumeData';

            class ResumeBuilder {
                constructor() {
                    this.data = {
                        fullName: '',
                        jobTitle: '',
                        email: '',
                        phone: '',
                        location: '',
                        professionalSummary: '',
                        experience: [],
                        education: [],
                        skills: ''
                    };
                    this.currentTemplate = 'professional';
                    this.init();
                }

                init() {
                    this.setupEventListeners();
                    this.loadFromStorage();
                    this.addExperienceItem();
                    this.addEducationItem();
                    this.updatePreview();
                }

                setupEventListeners() {
                    // Form inputs
                    const inputs = ['fullName', 'jobTitle', 'email', 'phone', 'location', 'professionalSummary', 'skills'];
                    inputs.forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.addEventListener('input', () => {
                                this.data[id] = element.value;
                                this.updatePreview();
                                this.autoSave();
                            });
                        }
                    });

                    // Template selector
                    document.getElementById('templateSelect').addEventListener('change', (e) => {
                        this.currentTemplate = e.target.value;
                        this.updatePreview();
                        this.autoSave();
                    });

                    // Buttons - PROPERLY BOUND
                    document.getElementById('addExperience').addEventListener('click', () => this.addExperienceItem());
                    document.getElementById('addEducation').addEventListener('click', () => this.addEducationItem());
                    document.getElementById('saveBtn').addEventListener('click', () => this.saveToStorage());
                    document.getElementById('loadBtn').addEventListener('click', () => this.loadFromStorage());
                    document.getElementById('clearBtn').addEventListener('click', () => this.clearData());
                }

                // ✅ UPDATED STORAGE METHODS
                saveToStorage() {
                    try {
                        const dataToSave = {
                            ...this.data,
                            template: this.currentTemplate
                        };
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(dataToSave));
                        this.showNotification('Resume saved successfully!', 'success');
                    } catch (error) {
                        this.showNotification('Error saving resume', 'error');
                    }
                }

                loadFromStorage() {
                    try {
                        const savedData = localStorage.getItem(STORAGE_KEY);
                        if (savedData) {
                            const parsed = JSON.parse(savedData);
                            this.data = { ...this.data, ...parsed };
                            this.currentTemplate = parsed.template || 'professional';
                            
                            // Update form fields
                            Object.keys(this.data).forEach(key => {
                                const element = document.getElementById(key);
                                if (element && typeof this.data[key] === 'string') {
                                    element.value = this.data[key];
                                }
                            });
                            
                            document.getElementById('templateSelect').value = this.currentTemplate;
                            
                            // Rebuild experience and education containers
                            this.refreshExperienceContainer();
                            this.refreshEducationContainer();
                            
                            this.updatePreview();
                            this.showNotification('Resume loaded successfully!', 'success');
                        } else {
                            this.showNotification('No saved resume found', 'info');
                        }
                    } catch (error) {
                        this.showNotification('Error loading resume', 'error');
                    }
                }

                clearData() {
                    if (confirm('Are you sure you want to clear all data?')) {
                        this.data = {
                            fullName: '',
                            jobTitle: '',
                            email: '',
                            phone: '',
                            location: '',
                            professionalSummary: '',
                            experience: [],
                            education: [],
                            skills: ''
                        };
                        this.currentTemplate = 'professional';
                        
                        // Clear form fields
                        const inputs = document.querySelectorAll('input, textarea, select');
                        inputs.forEach(input => {
                            if (input.id !== 'templateSelect') {
                                input.value = '';
                            }
                        });
                        
                        document.getElementById('templateSelect').value = 'professional';
                        document.getElementById('experienceContainer').innerHTML = '';
                        document.getElementById('educationContainer').innerHTML = '';
                        
                        this.addExperienceItem();
                        this.addEducationItem();
                        this.updatePreview();
                        
                        localStorage.removeItem(STORAGE_KEY);
                        this.showNotification('Data cleared successfully!', 'success');
                    }
                }

                // ... REST OF YOUR METHODS (addExperienceItem, updatePreview, etc.) ...
                // Keep all your other existing methods unchanged
                // =============================================
            }

            // Initialize the resume builder
            const resumeBuilder = new ResumeBuilder();
        });
    </script>
</body>
</html>
